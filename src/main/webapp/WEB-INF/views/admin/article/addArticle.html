<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lesson</title>
    <link rel="stylesheet" href="/resources/frontend/libraries/bootstrap.css">
    <link rel="stylesheet" href="/resources/frontend/workField.css">
    <!--<link rel="stylesheet" href="/resources/frontend/editLesson/css/editLesson.css">-->
    <script src="/resources/frontend/libraries/jquery-2.2.4.min.js"></script>
    <script src="/resources/frontend/libraries/bootstrap.min.js"></script>
    <script src="/resources/ckeditor/ckeditor.js"></script>
    <script async src="/resources/frontend/editLesson/addArticle.js"></script>

    <script>
        function sendAjaxRequest() {
            var resourceGroupType = $("#resourceGroupType").val();
            $.get("/admin/article/categories?categoryId=" + resourceGroupType, function (data, status) {
                $("#chapter").empty();
//                data.forEach(function (item) {
//                    var option = "<option value = " + item + " text=>" + item + "</option>";
//                    $("#chapter").append(option);
//                });
                for (var key in data) {
                    var option = "<option value = " + key + ">" + data[key] + "</option>";
                    $("#chapter").append(option);
                }
//                 alert("Data: " + data + "\nStatus: " + status);
            });
        };
    </script>

    <script>
        $(document).ready(
                function () {
                    $("#resourceGroupType").change(function() {
                        sendAjaxRequest();
                    });
                }
        );
    </script>

    <style>
        #cke_editor1{
            margin-left:32px;
        }
    </style>

</head>

<div th:replace="admin/fragments/body :: body(~{::main}, '','/admin/article/', 'Стаття')"></div>

<div th:remove="all">
    <div th:fragment="main">

        <form action="#" th:action="@{/admin/article/}" th:object="${article}" method="post">

            <div class=' form-group'>
                <label for="title">Заголовок:</label>
                <input class=" form-control" id='title' type="text" th:field="*{articleName}" placeholder="Введіть заголовок" />
            </div>
                       <div class="row">

                        <div class="col-xs-4 form-group">
                            <label>Категорiя</label><br/>
                            <textarea disabled th:text="${article.resourceGroupType == null ? '': article.resourceGroupType.getCaption()}"/>
                        </div>

                        <div class="col-xs-4 form-group">
                            <label>Роздiл</label><br/>
                            <textarea disabled th:text="${currentChapter.getChapterName()}"/>

                        </div>
                    </div >


            <label>Змінити категорiю, розділ та право перегляду:</label><br/>
            <div class="row">
                <div class="col-xs-4 form-group">
                    <select th:field="*{resourceGroupType.resourceGroupTypeId}" class="form-control" id="resourceGroupType">
                        <option th:each="resourceGroupType : ${resourceGroupTypeList}"
                                th:value="${resourceGroupType.resourceGroupTypeId}"
                                th:text="${resourceGroupType.getCaption()}">Wireframe
                        </option>
                    </select>
                </div>

                <div class="col-xs-4 form-group">
                    <select th:field="*{chapterId}" class="form-control" id="chapter">
                        <option th:each="chapter1 : ${currentChapterList}"
                                th:value="${chapter1.getChapterId()}"
                                th:text="${chapter1.getChapterName()}">Wireframe
                        </option>
                    </select>
                </div>
                <div th:class="${'col-xs-4 form-group' + ( #fields.hasErrors('role') ? ' has-error' : '') }">
                    <select class="form-control" th:field="*{role.roleId}">
                        <option th:each="role : ${roleList}"
                                th:value="${role.roleId}"
                                th:text="${role.roleName}"></option>
                    </select>
                </div>
            </div>

            <!--<td>-->
   <!---->
            <!--</td>-->

                    <input type="hidden" th:field="*{articleId}" placeholder="bfsdkjhbvdj"/>
                    <div>
                        <ol>
                            <p class="category">Категорія</p>
                            <li class="mylist" th:each=" resourceGroupType : ${resourceGroupTypeList}">
                            <span class="category-name">
                                <span th:text="${resourceGroupType.groupName}">Test</span>
                                <a th:href="@{/admin/chapter/add/group/} + ${resourceGroupType.resourceGroupTypeId}">Додати розділ</a>
                            </span>
                                <ol class="category-item">
                                    <p class="section">Розділ</p>

                                    <li th:each="chapter :  ${resourceGroupType.chapterList}">
                                        <a th:href="${'javascript:myFunction('+ chapter.chapterId + ',' + resourceGroupType.resourceGroupTypeId + ')'}") ><td th:text="${chapter.chapterName}"></td></a>
                                        <a th:href="@{/admin/chapter/edit/} + ${chapter.chapterId}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
                                        <a th:href="@{/admin/chapter/delete/} + ${chapter.chapterId}"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a>
                                    </li>
                                </ol>
                            </li>
                        </ol>
                    </div>
                    <script>
                        //                    var data = CKEDITOR.instances.editor1.getData();
                    </script>
                    <div class="row row_textarea">
                <textarea th:field="*{context}" name="editor1" id="editor1" rows="10" cols="60">
                Вводите урок сюда.
            </textarea>
                        <script>
                            CKEDITOR.replace('editor1' ,{
                                language: 'ru',
                                uiColor: '#9AB8F3', // to pick color
                                height: 400,
                                width: 650,
                                margin: '0 auto'
                            });
                        </script>
                        <br/>
                        <input style='margin-left:32px;' class="btn btn-success" type="submit" value="Добавить статью"/>
                    </div>

                </form>
                <script>
                    function myFunction(chapterName, groupName) {
                        document.getElementById("chapterId").value = chapterName;
                        document.getElementById("groupName").value = groupName;
                    }
                </script>



    </div>
</div>

</html>



