<!DOCTYPE html>
<html lang="ukr" xmlns:th="http://www.thymeleaf.org">
<head th:replace="home/fragments/head :: head('НАЗВАНИЕ СТРАНИЦЫ')"></head>
<head>
    <!--СЮДА МОЖНО ДОБАВИТЬ ВСЁ, ЧЕГО НЕТУ В head.HTML-->
</head>
<body>
<div th:replace="home/fragments/body :: body(~{::main}, '', false, '')"></div>

<div th:remove="all">
    <main class="my-way-main"  th:fragment="main">
        <div class="messageList1">
            <div class="container-fluid messageList-header">
                <p class="col-xs-4 messageList-header-title" th:text="${chat.getChatTitle()}">Название беседы</p>
                <!--<select class="col-xs-4 messageList-header-select" name="Settings" >-->
                <!--<option selected value="settings">Налаштування</option>-->
                <!--<option th:action="@{/home/messages/} + ${chat.chatId} + '/addMembers'" th:method="get" value="add buddy">Додати співрозмовників</option>-->
                <!--&lt;!&ndash;<option th:href="@{}" value="change title">Змінити назву бесіди</option>&ndash;&gt;-->
                <!--<option th:action="@{/home/messages/} + ${chat.chatId} + '/leaveChat'" th:method="post" value="leave chat">Покинути бесіду</option>-->
                <!--</select>-->
                <!-- Если это диалог, то существует переменная dialog и настройка чата не отображается -->
                <div th:if="${dialog == null}">

                    <ul>
                        <li>
                            <a th:href="@{/home/messages/} + ${chat.chatId} + '/edit'">Налаштування бесіди</a>
                        </li>
                        <li>
                            <a th:href="@{/home/messages/} + ${chat.chatId} + '/addMembers'">Додати співрозмовників</a>
                        </li>
                        <li>
                            <a th:href="@{/home/messages/} + ${chat.chatId} + '/leaveChat'">Залишити бесіду</a>
                        </li>
                        <li th:if="${ownerPermission == true}">
                            <a th:href="@{/home/messages/} + ${chat.chatId} + '/deleteChat'" >Видалити бесіду</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="messageList-content">
                <div class="container-fluid markList messageList-content-msgField" th:unless="${#lists.isEmpty(messagesList)}">
                    <div th:each="message : ${messagesList}">
                        <div th:if="${message.functional == true}" class="msgField-advert">
                            <b th:text="${message.content}"></b>
                        </div>
                        <div th:if="${message.functional != true}" class="msgField-letter">
                            <span class="col-xs-12 msgField-letter-author" th:text="${message.sender.getFirstName()} + ' ' + ${message.sender.getLastName()}"></span>
                            <!--<span class="msgField-letter-id" th:text="${message.messageId}"></span>-->
                            <span class="msgField-letter-content" th:text="${message.content}"></span>
                            <!--<span th:if="${#dates.createToday().getDay()} == ${message.createdAt.date}"></span>-->
                            <span class="msgField-letter-time" th:text="
                                ${#dates.format(#dates.createNow(), 'dd-MM-yyyy') == #dates.format(message.createdAt, 'dd-MM-yyyy')} ?
                                ${#dates.format(message.createdAt, 'HH:mm')} :
                                ${#dates.format(message.createdAt, 'dd-MM-yyyy HH:mm')}"></span>
                        </div>
                    </div>
                </div>
                <div class="messageList-content-newMsg">
                    <form action="#" th:action="@{/home/messages/} + ${chat.chatId}" method="post" th:object="${message}">
                        <input type="hidden" th:field="*{messageId}">
                        <div hidden><select th:field="*{chat.chatId}"><option hidden th:value="${chat.chatId}"></option></select></div>
                        <input type="text" class="form-control messageList-content-newMsg-input" placeholder="Введіть повідомлення" th:field="*{content}" required>
                        <button class=' btn btn-primary messageList-content-newMsg-button' type="submit">Відправити</button>
                    </form>
                </div>
            </div>
        </div>
    </main>
</div>
</body>
</html>